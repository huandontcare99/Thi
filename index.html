<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Trắc nghiệm Cơ Sở Dữ Liệu</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 20px;
      background: #f4f4f4;
      color: #333;
    }
    h1 {
      text-align: center;
      color: #2c3e50;
    }
    #timer {
      text-align: center;
      font-size: 20px;
      margin: 15px 0;
      color: #d63031;
    }
    .question {
      background: white;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      transition: all 0.3s;
      border-left: 6px solid transparent;
    }
    .question.correct { border-left-color: green; }
    .question.incorrect { border-left-color: red; }
    .options label {
      display: block;
      padding: 8px;
      background: #f0f0f0;
      border-radius: 5px;
      margin-top: 5px;
      cursor: pointer;
      transition: 0.2s;
    }
    .options input[type="radio"] {
      margin-right: 10px;
    }
    .options label:hover {
      background: #dfe6e9;
    }
    .correct-answer {
      margin-top: 8px;
      font-weight: bold;
      color: green;
    }
    button {
      padding: 12px 25px;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      background: #0984e3;
      color: white;
      cursor: pointer;
      margin: 15px auto;
      display: block;
    }
    button:hover {
      background: #0652DD;
    }
    #result {
      font-weight: bold;
      text-align: center;
      background: white;
      padding: 15px;
      margin-top: 20px;
      border-radius: 6px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
    #quizForm, #submitBtn, #result, #timer {
      display: none;
    }
    @media (max-width: 600px) {
      body {
        padding: 10px;
      }
    }
  </style>
</head>
<body>
  <h1>Bài Trắc Nghiệm Cơ Sở Dữ Liệu</h1>
  <div id="timer">Thời gian còn lại: 05:00</div>
  <form id="quizForm"></form>
  <button id="submitBtn">Nộp bài</button>
  <div id="result"></div>
  <button id="startBtn">Bắt đầu làm bài</button>

  <script>
    const rawData = `
Cho quan hệ R(A, B, C, D) và các thể hiện sau:Trong đó: A: chuỗi 20 bytes B: số nguyên 4 bytes C: ngày 8 bytes D: chuỗi 68 bytes Mỗi mẫu tin trong quan hệ R bao nhiêu Byte?
• 110
✅ 100
• 68
• 600

Cho quan hệ R(A, B, C, D) và các thể hiện sau:Trong đó: A: chuỗi 20 bytes B: số nguyên 4 bytes C: ngày 8 bytes D: chuỗi 68 bytes 1 block = 1024 bytes (block header: 24 bytes) Các giá trị T(R), S(R), B(R) là bao nhiêu?
✅ T(R) = 6; S(R) = 100; B(R) = 1
• T(R) = 5; S(R) = 100; B(R) = 1
• T(R) = 6; S(R) = 120; B(R) = 1
• T(R) = 6; S(R) = 100; B(R) = 2

Cho quan hệ R(A, B, C, D) và các thể hiện sau:Các giá trị V(R,A), V(R,B), V(R,C), V(R,D) là bao nhiêu?
✅ V(R,A) = 3, V(R,B) = 2, V(R,C) = 5, V(R,D) = 4
• V(R,A) = 6, V(R,B) = 2, V(R,C) = 5, V(R,D) = 4
• V(R,A) = 3, V(R,B) = 2, V(R,C) = 200, V(R,D) = 4
• V(R,A) = 3, V(R,B) = 2, V(R,C) = 5, V(R,D) = 6

Phân tích cú pháp thuộc giai đoạn nào trong các giai đoạn phân tích câu truy vấn?
✅ Phân tích
• Tối ưu
• Sinh mã
• Thực thi

Quá trình xử lý truy vấn được chia thành những giai đoạn chính nào?
✅ Phân tích, tối ưu, sinh mã và thực thi câu truy vấn.
• Tối ưu, sinh mã và thực thi câu truy vấn.
• Phân tích, tối ưu, thực thi câu truy vấn.
• Phân tích, sinh mã và thực thi câu truy vấn.

Quá trình xử lý truy vấn được chia thành mấy giai đoạn chính?
• 2
• 3
✅ 4
• 5

Cho bảng Tài khoản gồm ba trường theo thứ tự: Mã tài khoản, Tên chi nhánh và Số dư. Với Tên chi nhánh là khóa tìm kiếm. Dữ liệu của bảng được minh họa như trong hình bên dưới. Tập tin chỉ mục dày của bảng Tài khoản có bao nhiêu mẫu tin?
• 4
✅ 5
• 6
• 7

Cho bảng tài khoản gồm ba trường theo thứ tự: Mã tài khoản, Tên chi nhánh và Số dư với Tên chi nhánh là khóa tìm kiếm. Dữ liệu của bảng được minh họa như trong hình bên dưới. Tập tin chỉ mục dày gồm những mẫu tin nào (theo đúng thứ tự)?
✅ Brighton, Downtown, Perryridge, RedWood, Round Hill
• Brighton, Downtown, Downtown, Perryridge, RedWood, Round Hill
• Brighton, Downtown, Downtown, Perryridge, Perryridge, Perryridge, RedWood, Round Hill
• RedWood, Round Hill, Perryridge, Downtown, Brighton

Tốc độ truyền dữ liệu là gì?
• Là khoảng thời gian từ khi yêu cầu đọc/viết được phát đi đến khi bắt đầu truyền dữ liệu.
• Thời gian chờ sector được truy xuất xuất hiện dưới đầu đọc/viết.
✅ Là tốc độ dữ liệu có thể được lấy ra từ đĩa hoặc được lưu trữ vào đĩa.
• Lượng thời gian trung bình hệ thống chạy liên tục không có bất kỳ sự cố nào.

Trong các phương tiện lưu trữ sau, phương tiện lưu trữ nào là nhanh nhất và đắt nhất?
✅ Cache
• Bộ nhớ chính
• Bộ nhớ Flash
• Lưu trữ đĩa từ

KHÔNG cho phép người sử dụng thực hiện phát biểu INSERT, UPDATE, DELETE trên tất cả các bảng dữ liệu của cơ sở dữ liệu thì người sử dụng đó phải có vai trò gì trên cơ sở dữ liệu?
• db_securityadmin
✅ db_denydawriter
• db_accessadmin
• db_ddladmin

KHÔNG cho phép người sử dụng thực hiện phát biểu SELECT trên tất cả các bảng dữ liệu của cơ sở dữ liệu thì người sử dụng đó phải có vai trò gì trên cơ sở dữ liệu?
• db_securityadmin
✅ db_denydareader
• db_accessadmin
• db_ddladmin

Người sử dụng được phép truy vấn dữ liệu (SELECT) trên các bảng dữ  liệu của người dùng khác trong cơ sở dữ liệu thì người sử dụng đó phải có vai trò gì trên cơ sở dữ liệu?
✅ db_datareader
• db_owner
• db_accessadmin
• db_ddladmin

Lệnh Create Procedure là lệnh dùng để tạo đối tượng nào trong cơ sơ dữ liệu?
• Cơ sở dữ liệu
• Bảng
• Khung nhìn
✅ Thủ tục lưu trữ

Lệnh Create Database là lệnh dùng để tạo đối tượng nào trong cơ sơ dữ liệu?
✅ Cơ sở dữ liệu
• Bảng
• Khung nhìn
• Thủ tục lưu trữ

Để cấp quyền truy cập vào các đối tượng trong cơ sở dữ liệu, ta dùng lệnh nào?
✅ GRANT
• DENY
• REVOKE
• CREATE RULE

Khi đăng nhập vào một hệ thống CSDL đa người dùng (SQL Server), người sử dụng cần phải cung cấp thông tin gì?
• tài khoản.
• mật khẩu.
✅ tài khoản và mật khẩu.
• quyền đăng nhập và mật khẩu.

Lệnh COMMIT TRANSACTION trong SQL dùng để làm gì?
• Đánh dấu một vị trí trong giao tác (gọi là điểm đánh dấu).
• Quay lui trở lại đầu giao tác hoặc một điểm đánh dấu trước đó trong giao tác.
✅ Đánh dấu điểm kết thúc một giao tác. Khi câu lệnh này thực thi cũng có nghĩa là giao tác đã thực hiện thành công.
• Bắt đầu một giao tác.

Trong SQL, bắt đầu giao tác ta dùng lệnh:
✅ BEGIN TRANSACTION
• SAVE TRANSACTION
• ROLLBACK TRANSACTION
• COMMIT TRANSACTION

Phát biểu nào sau đây là ĐÚNG?
• Đồ thị trình tự của lịch S tồn tại chu trình thì lịch S khả tuần tự xung đột.
✅ Lịch S khả tuần tự xung đột thì S khả tuần tự.
• Hoán vị được thứ tự của hai hành động xung đột nhau.
• Nếu hai đồ thị trình tự của lịch S 1 và S 2 giống nhau thì S 1 và S 2 là tương đương xung đột nhau.

Phát biểu nào sau đây là ĐÚNG?
• Đồ thị trình tự của lịch S tồn tại chu trình thì lịch S khả tuần tự xung đột.
• Lịch S khả tuần tự thì S khả tuần tự xung đột.
• Hoán vị được thứ tự của hai hành động xung đột nhau.
✅ S 1 và S 2 là tương đương xung đột nhau thì hai đồ thị trình tự của chúng giống nhau.

Phát biểu nào sau đây là ĐÚNG?
✅ Đồ thị trình tự của lịch S không tồn tại chu trình thì lịch S khả tuần tự xung đột.
• Lịch S khả tuần tự thì S khả tuần tự xung đột.
• Hoán vị được thứ tự của hai hành động xung đột nhau.
• Nếu hai đồ thị trình tự của lịch S 1 và S 2 giống nhau thì S 1 và S 2 là tương đương xung đột nhau.

Cho lịch S 6 xử lý đồng thời gồm hai giao tác T 1 và T 2 . Các cặp hành động nào là xung đột nhau?
• (2) – (4), (3) – (5), (4) – (6)
• (2) – (3), (3) – (6), (4) – (6)
• (1) – (2), (1) – (4), (2) – (4)
✅ (3) – (6), (4) – (5), (4) – (6)

Cho lịch S 6 xử lý đồng thời gồm hai giao tác T 1 và T 2 . Các cặp hành động nào KHÔNG xung đột nhau? [
✅ (4) – (5), (2) – (7), (2) – (8)
• (2) – (3), (3) – (6), (4) – (6)
• (1) – (2), (1) – (4), (2) – (4)
• (3) – (6), (4) – (5), (6) – (7)

Cho lịch S 6 xử lý đồng thời gồm hai giao tác T 1 và T 2 . Các cặp hành động nào là xung đột nhau?
• (2) – (4), (3) – (5), (4) – (6)
• (2) – (3), (3) – (6), (4) – (6)
✅ (1) – (4), (2) – (3), (2) – (4)
• (1) – (4), (3) – (6), (4) – (6)

Cho S 2 là lịch tuần tự với hai giao tác T 1 , T 2 và hai đơn vị dữ liệu A, B, với A = B = 50 là giá trị ban đầu (như hình bên dưới). Khi hai giao tác T 1 , T 2 thực hiện, các giá trị của A, B tại các số (1), (2), (3) và (4) là bao nhiêu?
• (1) = 100; (2) = 200; (3) = 300; (4) = 400
• (1) = 100; (2) = 150; (3) = 150; (4) = 150
• (1) = 100; (2) = 200; (3) = 200; (4) = 250
✅ (1) = 100; (2) = 100; (3) = 200; (4) = 200

Hệ quản trị cơ sở dữ liệu là gì?
• Là phần cứng của máy tính.
• Là cơ sở dữ liệu ở mức vật lí.
✅ Là một hệ thống phần mềm cho phép người dùng định nghĩa, tạo và duy trì cơ sở dữ liệu (CSDL), đồng thời cung cấp dịch vụ truy cập đến CSDL một cách có quản lý.
• Là phần mềm hệ thống.

Hình dưới mô tả kiến trúc của hệ quản trị cơ sở dữ liệu được đề xuất bởi Thomas 2005. Hệ quản trị cơ sở dữ liệu là thành phần tại vị trí số mấy trong các vị trí trên?
• (1)
• (2)
• (3)
✅ (4)

Nội dung bên dưới mô tả cho chức năng của thành phần nào trong một hệ quản trị cơ sở dữ liệu? “Nhận vào các mã đối tượng chương trình và các truy vấn, đối chiếu với lược đồ ngoài và lược đồ quan niệm để xác định các mẫu tin quan niệm cần thiết để trả lời truy vấn”.
• Bộ xử lý truy vấn (Query processor).
✅ Bộ quản lý CSDL (Database Manager).
• Bộ tiền xử lý ngôn ngữ DML (DML preprocessor).
• Trình biên dịch (DDL compiler).

Nội dung bên dưới mô tả cho chức năng của thành phần nào trong một hệ quản trị cơ sở dữ liệu? “Bộ phận này biến đổi các lệnh thao tác dữ liệu như insert, delete, update,… thành các lời gọi hàm chuẩn. Bộ phận này phải tương tác với bộ xử lý truy vấn để sinh mã phù hợp”.
• Bộ xử lý truy vấn (Query processor).
• Bộ quản lý CSDL (Database Manager).
✅ Bộ tiền xử lý ngôn ngữ DML (DML preprocessor).
• Trình biên dịch (DDL compiler).

Giao tác đúng đắn là giao tác?
✅ Trước khi muốn đọc/viết lên một đơn vị dữ liệu nào thì phải phát ra yêu cầu khóa đơn vị dữ liệu đó. Sau khi đọc/viết xong thì phải giải phóng cho đơn vị dữ liệu đã bị khóa.
• Trước khi muốn đọc/viết lên một đơn vị dữ liệu nào thì cứ đọc viết đơn vị dữ liệu đó, sau đó giải phóng cho đơn vị dữ liệu đã bị khóa.
• Trước khi muốn đọc/viết lên một đơn vị dữ liệu nào thì phải phát ra yêu cầu khóa đơn vị dữ liệu đó.
• Khi muốn đọc/viết lên một đơn vị dữ liệu nào thì đọc/viết lên đơn vị dữ liệu đó rồi sau đó phát ra yêu cầu khóa và giải phóng khóa cho đơn vị dữ liệu vừa đọc viết.

Hai hình bên dưới minh họa cho quy tắc nào? 
✅ Quy tắc lịch hợp lệ của kỹ thuật khóa đọc viết.
• Quy tắc lịch hợp lệ của kỹ thuật khóa thông thường.
• Quy tắc giao tác đúng đắn của kỹ thuật khóa đọc viết.
• Quy tắc khóa hai giai đoạn của kỹ thuật khóa đọc viết.

Hình bên dưới minh họa cho quy tắc nào?
✅ Quy tắc giao tác đúng đắn của kỹ thuật khóa đọc viết.
• Quy tắc giao tác đúng đắn của kỹ thuật khóa thông thường.
• Quy tắc lịch hợp lệ của kỹ thuật khóa đọc viết.
• Quy tắc khóa hai giai đoạn.

Hình bên dưới minh họa cho trường hợp nào trong quy tắc khóa hai giai đoạn của kỹ thuật khóa đọc viết?
• Nâng cấp xin nhiều khóa hơn.
✅ Nâng cấp giải phóng khóa đọc.
• Cả nâng cấp xin nhiều khóa hơn và nâng cấp giải phóng khóa đọc.
• Ma trận tương thích.

Hình bên dưới minh họa cho trường hợp nào trong quy tắc khóa hai giai đoạn của kỹ thuật khóa đọc viết?
✅ Nâng cấp xin nhiều khóa hơn.
• Nâng cấp giải phóng khóa đọc.
• Cả nâng cấp xin nhiều khóa hơn và nâng cấp giải phóng khóa đọc.
• Ma trận tương thích.

Tính cô lập (Isolation) của giao tác là gì?
• Hoặc toàn bộ các hoạt động của giao tác được phản ánh đúng đắn trong CSDL hoặc không có gì cả.
• Sự thực hiện của một giao tác là cô lập để bảo tồn tính nhất quán của CSDL.
✅ Cho dù nhiều giao tác có thể thực hiện đồng thời, hệ thống phải đảm bảo rằng đối với mỗi cặp giao tác T i , T j , hoặc T j kết thúc thực hiện trước khi T i khởi động hoặc T j bắt đầu sự thực hiện sau khi T i kết thúc. Như vậy mỗi giao tác không cần biết đến các giao tác khác đang thực hiện đồng thời trong hệ thống.
• Sau một giao tác hoàn thành thành công, các thay đổi đã được tạo ra đối với CSDL vẫn còn khi xảy ra sự cố hệ thống.

Trạng thái Được bàn giao bộ phận (Partially Committed) của giáo tác là:
• Sau khi hoàn thành thành công giao tác.
✅ Sau khi lệnh cuối cùng được thực hiện.
• Sau khi phát hiện rằng sự thực hiện không thể tiếp tục được nữa.
• Sau khi giao tác đã bị quây lui và CSDL đã phục hồi lại trạng thái của nó trước khi khởi động giao tác.
`.trim();

    function shuffleArray(array) {
      return array
        .map(value => ({ value, sort: Math.random() }))
        .sort((a, b) => a.sort - b.sort)
        .map(({ value }) => value);
    }

    const originalQuestions = rawData.split("\n\n").map(block => {
      const lines = block.trim().split('\n');
      const question = lines[0];
      const answers = lines.slice(1).map(line => {
        const isCorrect = line.trim().startsWith("✅");
        const text = line.replace(/^✅|^•/, '').trim();
        return { text, isCorrect };
      });
      return { question, answers };
    });

    let questions = [];
    const form = document.getElementById('quizForm');
    const timerEl = document.getElementById('timer');
    const resultEl = document.getElementById('result');
    const submitBtn = document.getElementById('submitBtn');
    const startBtn = document.getElementById('startBtn');
    let timeLeft = 300;
    let timerInterval;

    function formatTime(sec) {
      const m = String(Math.floor(sec / 60)).padStart(2, '0');
      const s = String(sec % 60).padStart(2, '0');
      return `${m}:${s}`;
    }

    function updateTimer() {
      timerEl.textContent = `Thời gian còn lại: ${formatTime(timeLeft)}`;
      if (timeLeft <= 0) {
        clearInterval(timerInterval);
        submitExam();
      }
      timeLeft--;
    }

    startBtn.onclick = () => {
      startBtn.style.display = 'none';
      timerEl.style.display = 'block';
      form.style.display = 'block';
      submitBtn.style.display = 'block';
      timeLeft = 300;
      questions = shuffleArray(originalQuestions).map(q => ({
        question: q.question,
        answers: shuffleArray(q.answers)
      }));
      renderQuestions();
      timerInterval = setInterval(updateTimer, 1000);
    };

    function renderQuestions() {
      form.innerHTML = '';
      questions.forEach((q, qIndex) => {
        const div = document.createElement('div');
        div.className = 'question';
        div.innerHTML = `<p><strong>Câu ${qIndex + 1}:</strong> ${q.question}</p>`;
        const options = document.createElement('div');
        options.className = 'options';
        q.answers.forEach((ans, aIndex) => {
          options.innerHTML += `
            <label>
              <input type="radio" name="q${qIndex}" value="${aIndex}">
              ${ans.text}
            </label>`;
        });
        div.appendChild(options);
        form.appendChild(div);
      });
    }

    submitBtn.onclick = submitExam;

    function submitExam() {
      clearInterval(timerInterval);
      const unanswered = [];
      let correct = 0;

      questions.forEach((q, qIndex) => {
        const selected = form.querySelector(`input[name="q${qIndex}"]:checked`);
        const div = form.children[qIndex];
        div.classList.remove("correct", "incorrect");
        const correctAnswer = q.answers.find(a => a.isCorrect);

        if (!selected) {
          unanswered.push(qIndex + 1);
          div.classList.add("incorrect");
          const feedback = document.createElement('div');
          feedback.className = 'correct-answer';
          feedback.textContent = `Bạn chưa chọn. Đáp án đúng: ${correctAnswer.text}`;
          div.appendChild(feedback);
        } else {
          const userAns = q.answers[parseInt(selected.value)];
          if (userAns.isCorrect) {
            div.classList.add("correct");
            correct++;
          } else {
            div.classList.add("incorrect");
            const feedback = document.createElement('div');
            feedback.className = 'correct-answer';
            feedback.textContent = `Đáp án đúng: ${correctAnswer.text}`;
            div.appendChild(feedback);
          }
        }
      });

      if (unanswered.length > 0) {
        alert(`Bạn chưa trả lời các câu: ${unanswered.join(', ')}`);
        return;
      }

      const score = Math.round((correct / questions.length) * 100);
      resultEl.style.display = 'block';
      resultEl.innerHTML = `
        ✅ Số câu đúng: ${correct}/${questions.length}<br>
        ❌ Số câu sai: ${questions.length - correct}<br>
        🎯 Điểm: ${score}/100
      `;
      submitBtn.disabled = true;
    }
  </script>
</body>
</html>
